<!DOCTYPE html>
<html lang="fr-FR">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>M2102-2 - TP1 Virtualbox | Cours - Sohaib LAFIFI</title>
    <meta name="generator" content="VuePress 1.5.0">
    
    <meta name="description" content="">
    <link rel="preload" href="/courses/assets/css/0.styles.1f12e6e4.css" as="style"><link rel="preload" href="/courses/assets/js/app.d7065bb8.js" as="script"><link rel="preload" href="/courses/assets/js/2.d8670f6e.js" as="script"><link rel="preload" href="/courses/assets/js/7.17f6a406.js" as="script"><link rel="prefetch" href="/courses/assets/js/10.54884e79.js"><link rel="prefetch" href="/courses/assets/js/11.26212ee3.js"><link rel="prefetch" href="/courses/assets/js/12.08e8cdf6.js"><link rel="prefetch" href="/courses/assets/js/13.ae085209.js"><link rel="prefetch" href="/courses/assets/js/14.21a23ab3.js"><link rel="prefetch" href="/courses/assets/js/15.849c841f.js"><link rel="prefetch" href="/courses/assets/js/3.6f398410.js"><link rel="prefetch" href="/courses/assets/js/4.685e2bcc.js"><link rel="prefetch" href="/courses/assets/js/5.e2b986b7.js"><link rel="prefetch" href="/courses/assets/js/6.f65beabc.js"><link rel="prefetch" href="/courses/assets/js/8.8e0bd5c2.js"><link rel="prefetch" href="/courses/assets/js/9.2bbbf80a.js">
    <link rel="stylesheet" href="/courses/assets/css/0.styles.1f12e6e4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/courses/" class="home-link router-link-active"><!----> <span class="site-name">Cours - Sohaib LAFIFI</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/courses/" class="nav-link">
  Modules
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/courses/" class="nav-link">
  Modules
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/courses/" class="sidebar-link">Modules</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/courses/M2102-2/" class="sidebar-heading clickable router-link-active open"><span>M2102-2 : Virtualisation</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/courses/M2102-2/TP/" class="sidebar-heading clickable router-link-active open"><span>TP</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/courses/M2102-2/TP/TP1.html" class="active sidebar-link">TP1 Virtualbox</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/courses/M2102-2/TP/TP1.html#premiere-machine-virtuelle" class="sidebar-link">Première machine virtuelle</a></li><li class="sidebar-sub-header"><a href="/courses/M2102-2/TP/TP1.html#les-additions-invite" class="sidebar-link">Les Additions invité</a></li><li class="sidebar-sub-header"><a href="/courses/M2102-2/TP/TP1.html#reseau" class="sidebar-link">Réseau</a></li><li class="sidebar-sub-header"><a href="/courses/M2102-2/TP/TP1.html#performances-cpu" class="sidebar-link">Performances CPU</a></li></ul></li><li><a href="/courses/M2102-2/TP/TP2.html" class="sidebar-link">TP2 Docker</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/courses/M2102-2/TP/TP2.html#installation" class="sidebar-link">Installation</a></li><li class="sidebar-sub-header"><a href="/courses/M2102-2/TP/TP2.html#utilisation" class="sidebar-link">Utilisation</a></li></ul></li><li><a href="/courses/M2102-2/TP/TP3.html" class="sidebar-link">TP3 VMware ESXi</a></li><li><a href="/courses/M2102-2/TP/TP4.html" class="sidebar-link">TP4 Comparaison</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/courses/M2105/" class="sidebar-heading clickable"><span>M2105 : Web dynamique</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="virtualbox"><a href="#virtualbox" class="header-anchor">#</a> Virtualbox</h1> <h2 id="premiere-machine-virtuelle"><a href="#premiere-machine-virtuelle" class="header-anchor">#</a> Première machine virtuelle</h2> <p>La documentation permettant l'installation de virtualbox se situe ici :
<a href="http://doc.ubuntu-fr.org/virtualbox" target="_blank" rel="noopener noreferrer">http://doc.ubuntu-fr.org/virtualbox<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>La documentation de référence de virtualbox se trouve ici :
<a href="http://www.virtualbox.org/wiki/End-user_documentation" target="_blank" rel="noopener noreferrer">http://www.virtualbox.org/wiki/End-user_documentation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><strong>Travail préliminaire :</strong></p> <ul><li>Monter le serveur nas du département dans votre arborescence : <code>mount -t nfs rt-nas:/mnt/distvm /srv/nas</code></li></ul> <ol><li><p>Installez la dernière version Oracle de <strong>virtualbox</strong> ainsi que  <strong>le pack d'extension</strong>. Pour plus d'informations consulter la section 3 sur <a href="http://doc.ubuntu-fr.org/virtualbox" target="_blank" rel="noopener noreferrer">cette page<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></li> <li><p>Pour créer une machine virtuelle, il faut spécifier à Virtualbox ses caractéristiques. Lancez Virtualbox et créez une machine virtuelle en utilisant l'interface graphique avec les paramètres suivants :</p> <ul><li>Nom : Ubuntu1</li> <li>Type : Ubuntu Linux 64 bits</li> <li>Stockage : 10G</li> <li>Pour toutes les autres options, prendre les valeurs par défaut</li></ul></li> <li><p>A partir de la commande file (faire un man pour interpréter les valeurs) et en inspectant les fichiers textes, indiquez quels fichiers ont été créés sur le disque, quel est leur type (binaire,  ascii) ainsi que leur rôle ? .</p></li> <li><p>Quelle est la taille actuelle du disque virtuel sur le disque ? Cela correspond-il au paramétrage ?</p></li> <li><p>Editez les paramètres de votre machine. Dans l'onglet « Stockage »,  ajoutez un disque CD/ROM virtuel pointant sur l'ISO de la dernière version de ubuntu qui se trouve sur <code>/srv/nas/</code> .  Bootez et faites une installation classique en créant un utilisateur primaire user.</p></li></ol> <p><em>Installer complètement une VM est aussi long qu'installer une  machine physique. En parallèle passez à la partie <a href="#docker">Docker</a>.</em></p> <h2 id="les-additions-invite"><a href="#les-additions-invite" class="header-anchor">#</a> Les Additions invité</h2> <p>Les Additions invité sont des pilotes adaptés pour les systèmes invités comme Windows ou ceux basés sur GNU/Linux qui permettent :</p> <ul><li>Un affichage graphique plus rapide (avec gestion de l'accélération 2D et 3D) et automatiquement adapté à la résolution graphique du système hôte,</li> <li>Le partage du presse-papier,</li> <li>Le partage des dossiers,</li> <li>Une capture/libération dynamique du curseur lorsque celui-ci se déplace entre système hôte et système invité.</li></ul> <p>Pour activer les Additions invité, lancez Virtualbox, puis le Système invité. Ensuite dans le menu <strong>Périphériques</strong>, cliquez sur <strong>Insérer l'image CD des Additions invité…</strong>. (La suite dépend du système invité.)</p> <p>Sur la machine invitée, installez les paquets nécésaires :</p> <div class="language- extra-class"><pre><code>sudo apt-get install build-essential  linux-headers-$(uname -r)
</code></pre></div><p>A partir du répertoire du cd monté executez la commande d'installation :</p> <div class="language- extra-class"><pre><code>sudo ./VBoxLinuxAdditions.run 
</code></pre></div><h2 id="reseau"><a href="#reseau" class="header-anchor">#</a> Réseau</h2> <p>Virtualbox permet de partager des répertoires entre la machine hôte et
la machine invité.</p> <ol><li><p>Créez un répertoire partagé à l'aide de l'interface graphique de Virtualbox pour votre machine Ubuntu1. Cochez la cache permanent mais PAS automatique car on veut ajuster les droits d'accès au répertoire.</p></li> <li><p>Montez le répertoire comme une partition externe de type vboxsf dans   le répertoire Shared de l'utilisateur de base 'user'. Est-ce que
user peut écrire dans ce répertoire. Pourquoi ?</p></li> <li><p>On veut que le montage soit automatique au démarrage. Pour cela,   modifiez /etc/fstab avec comme nom du volume, le nom donné dans l'interface Virtualbox, comme type vboxfs et comme options uid= et gid= mis aux bonnes valeurs pour l'utilisateur user (probablement 1000).</p></li> <li><p>Etudions maintenant le type d'interconnexion réseau de la machine. Nous allons maintenant comparer les performances réseaux des modes <strong>NAT</strong> et <strong>pont (bridge)</strong>.</p></li></ol> <ul><li><p>Configurez apt-get pour passer par le proxy en créant le fichier <code>/etc/apt/apt.conf.d/proxy</code> :</p> <div class="language- extra-class"><pre><code>Acquire::http::Proxy &quot;http://cache-etu.univ-artois.fr:3128/&quot;;
</code></pre></div></li> <li><p>Pour faire les tests de performance, on va utiliser deux machines (une avec une connexion de type NAT et une autre en pont (avec une adresse MAC connue par le serveur dhcp, <code>08:00:27:00:03:XX</code> (XX est votre numéro) !)). Créez une nouvelle machine Ubuntu2 en faisant un  clone de la première. Mais <strong>avant</strong> installez l'outil iperf dont le manuel d'utilisation est ici <a href="http://openmaniak.com/iperf.php" target="_blank" rel="noopener noreferrer">http://openmaniak.com/iperf.php<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Quel est le débit obtenu en mode NAT et en mode bridge ? Quelle configuration d'iperf avez-vous utilisez ?</p></li></ul> <h2 id="performances-cpu"><a href="#performances-cpu" class="header-anchor">#</a> Performances CPU</h2> <p>Nous allons faire tourner un benchmark en lui faisant tester la vitesse d'excécution d'un programme de calcul de nombre premiers avec un nombre de threads variables (on le fait varier si on a plusieurs cœurs associés à l'OS) afin de comparer les performances dans la machine virtuelle et dans la machine physique.</p> <ol><li><p>Installez le benchmark sysbench (par un apt-get install classique)</p></li> <li><p>Faites tourner le benchmark en lui faisant tester la vitesse  d'excécution d'un programme effectuant 10000 calculs dans une seule thread à l'aide de la commande suivante :\</p> <div class="language- extra-class"><pre><code>sysbench --test=cpu --cpu-max-prime=10000 --num-threads=1 run | grep &quot;total time:&quot;
</code></pre></div></li> <li><p>Si il a N cœurs à sa disposition et N threads, chaque thread fera  10000/N calculs donc le temps total est divisé par N.  Comparez en les commantant les performances dans la machine    virtuelle et dans la machine physique.</p></li></ol></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/13/2020, 6:11:43 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/courses/" class="prev router-link-active">
        Modules
      </a></span> <span class="next"><a href="/courses/M2102-2/TP/TP2.html">
        TP2 Docker
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/courses/assets/js/app.d7065bb8.js" defer></script><script src="/courses/assets/js/2.d8670f6e.js" defer></script><script src="/courses/assets/js/7.17f6a406.js" defer></script>
  </body>
</html>
